{
  "portal_url": "https://www.broadbandchecker.btwholesale.com/#/ADSL/AddressHome",
  "extraction_rules": [
    {
      "field_name": "vdsl_range_a_downstream_high",
      "selector_path": "VDSL Range A (Clean) -> Downstream Line Rate -> High",
      "data_type": "number",
      "required": true,
      "description": "Maximum downstream speed for VDSL Range A"
    },
    {
      "field_name": "vdsl_range_a_downstream_low",
      "selector_path": "VDSL Range A (Clean) -> Downstream Line Rate -> Low",
      "data_type": "number",
      "required": true,
      "description": "Minimum downstream speed for VDSL Range A"
    },
    {
      "field_name": "vdsl_range_a_upstream_high",
      "selector_path": "VDSL Range A (Clean) -> Upstream Line Rate -> High",
      "data_type": "number",
      "required": false,
      "description": "Maximum upstream speed for VDSL Range A"
    },
    {
      "field_name": "vdsl_range_a_upstream_low",
      "selector_path": "VDSL Range A (Clean) -> Upstream Line Rate -> Low",
      "data_type": "number",
      "required": false,
      "description": "Minimum upstream speed for VDSL Range A"
    },
    {
      "field_name": "vdsl_range_b_downstream_high",
      "selector_path": "VDSL Range B (Impacted) -> Downstream Line Rate -> High",
      "condition_field": "gfast_range_a_available",
      "condition_value": "false",
      "data_type": "number",
      "required": false,
      "description": "Maximum downstream speed for VDSL Range B (when G.fast unavailable)"
    },
    {
      "field_name": "vdsl_range_b_downstream_low",
      "selector_path": "VDSL Range B (Impacted) -> Downstream Line Rate -> Low",
      "condition_field": "gfast_range_a_available",
      "condition_value": "false",
      "data_type": "number",
      "required": false,
      "description": "Minimum downstream speed for VDSL Range B"
    },
    {
      "field_name": "downstream_handback_threshold",
      "selector_path": "Downstream Handback Threshold(Mbps)",
      "data_type": "number",
      "required": false,
      "description": "Handback threshold for downstream"
    },
    {
      "field_name": "gfast_range_a_available",
      "selector_path": "G.fast Range A (Clean) -> WBC SOGEA Availability",
      "data_type": "boolean",
      "transform": "available_to_boolean",
      "required": true,
      "description": "G.fast Range A availability status"
    },
    {
      "field_name": "gfast_range_b_available",
      "selector_path": "G.fast Range B (Impacted) -> WBC SOGEA Availability",
      "data_type": "boolean",
      "transform": "available_to_boolean",
      "required": false,
      "description": "G.fast Range B availability status"
    },
    {
      "field_name": "fttp_available",
      "selector_path": "FTTP on Demand -> Availability Date",
      "data_type": "boolean",
      "transform": "available_to_boolean",
      "required": true,
      "description": "FTTP availability status"
    },
    {
      "field_name": "fttp_install_process",
      "selector_path": "FTTP Install Process",
      "data_type": "string",
      "required": false,
      "description": "FTTP installation process details"
    },
    {
      "field_name": "wbc_fttc_available",
      "selector_path": "WBC FTTC Availability",
      "data_type": "boolean",
      "transform": "available_to_boolean",
      "required": false,
      "description": "WBC FTTC availability status"
    },
    {
      "field_name": "wbc_sogea_available",
      "selector_path": "WBC SOGEA Availability",
      "data_type": "boolean",
      "transform": "available_to_boolean",
      "required": false,
      "description": "WBC SOGEA availability status"
    },
    {
      "field_name": "wlr_withdrawal",
      "selector_path": "WLR Withdrawal",
      "data_type": "boolean",
      "transform": "yn_to_boolean",
      "required": true,
      "description": "WLR withdrawal status"
    },
    {
      "field_name": "soadsl_restriction",
      "selector_path": "SOADSL Restriction",
      "data_type": "boolean",
      "transform": "yn_to_boolean",
      "required": true,
      "description": "SOADSL restriction status"
    },
    {
      "field_name": "exchange_name",
      "selector_path": "Exchange",
      "data_type": "string",
      "required": true,
      "description": "Exchange name serving the address"
    },
    {
      "field_name": "cabinet_number",
      "selector_path": "Cabinet",
      "data_type": "string",
      "required": true,
      "description": "Cabinet number serving the address"
    }
  ],
  "address_matching_rules": {
    "priority_order": ["exact", "postcode_and_number", "fuzzy"],
    "fuzzy_threshold": 0.8,
    "handle_flats": true,
    "handle_business_names": true
  },
  "conditional_extraction_logic": {
    "primary_speed_source": {
      "condition": "gfast_range_a_available == true",
      "true_extract": ["gfast_range_a_downstream", "gfast_range_a_upstream"],
      "false_extract": ["vdsl_range_a_downstream_high", "vdsl_range_a_downstream_low"]
    },
    "fallback_speed_source": {
      "condition": "vdsl_range_a_downstream_high == null",
      "true_extract": ["vdsl_range_b_downstream_high", "vdsl_range_b_downstream_low"]
    }
  },
  "output_format": {
    "csv_columns": [
      "address",
      "postcode",
      "exchange_name",
      "cabinet_number",
      "vdsl_range_a_downstream_high",
      "vdsl_range_a_downstream_low",
      "fttp_available",
      "gfast_range_a_available",
      "wlr_withdrawal",
      "recording_path"
    ],
    "include_timestamp": true,
    "include_session_id": true
  },
  "error_handling": {
    "retry_on_failure": true,
    "max_retries": 2,
    "retry_delay_seconds": 5,
    "save_partial_results": true,
    "fallback_on_timeout": true
  },
  "performance": {
    "max_steps": 20,
    "timeout_seconds": 120,
    "parallel_batch_size": 5,
    "rate_limit_delay_ms": 2000
  }
}