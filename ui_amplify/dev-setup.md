# Amplify Gen 2 Development Setup

## Correct Development Workflow

### Option 1: Run sandbox from ui_amplify directory (Recommended)
This keeps everything contained within the UI project:

```bash
cd ui_amplify
npx ampx sandbox
# In another terminal:
cd ui_amplify
npm run dev
```

### Option 2: Run sandbox from root directory
If you need to run sandbox from root:

```bash
# From root directory
npx ampx sandbox --dir-to-watch ui_amplify/amplify --outputs-out-dir ui_amplify

# In another terminal:
cd ui_amplify
npm run dev
```

## Understanding the Structure

- **Backend Definition**: `ui_amplify/amplify/backend.ts`
- **Lambda Functions**: `ui_amplify/amplify/backend/function/*/`
- **GraphQL Schema**: `ui_amplify/amplify/data/resource.ts`
- **Auth Config**: `ui_amplify/amplify/auth/resource.ts`
- **Output File**: `amplify_outputs.json` (gitignored, generated by sandbox)

## Common Issues

### Module Export Error
If you get "does not provide an export named" error:
1. Check that the function is properly exported in `resource.ts`
2. Ensure the function is imported in `backend.ts`
3. Verify the function is added to the `defineBackend` call

### amplify_outputs.json Location
- This file should be in the same directory where you run `npm run dev`
- If running sandbox from root, use `--outputs-out-dir` flag
- The file is auto-generated and should not be committed

## Quick Commands

```bash
# Start development (from ui_amplify directory)
npx ampx sandbox

# In new terminal (from ui_amplify directory)
npm run dev

# Stop sandbox
Ctrl+C in sandbox terminal
```