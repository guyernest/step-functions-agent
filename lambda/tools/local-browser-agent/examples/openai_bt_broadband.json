{
  "name": "BT Broadband Availability Check (OpenAI)",
  "description": "Check BT broadband availability using explicit Playwright locators and vision extraction",
  "llm_provider": "openai",
  "llm_model": "gpt-4o-mini",
  "starting_page": "https://www.productsandservices.bt.com/products/broadband/packages/",
  "abort_on_error": true,
  "steps": [
    {
      "action": "wait",
      "description": "Wait for page to load",
      "duration": 3000
    },
    {
      "action": "click",
      "description": "Click 'Check availability' button",
      "locator": {
        "strategy": "text",
        "value": "Check availability"
      }
    },
    {
      "action": "wait",
      "description": "Wait for postcode input",
      "locator": {
        "strategy": "selector",
        "value": "#postcode"
      },
      "timeout": 10000
    },
    {
      "action": "fill",
      "description": "Enter postcode",
      "locator": {
        "strategy": "selector",
        "value": "#postcode"
      },
      "value": "{{postcode}}"
    },
    {
      "action": "click",
      "description": "Click search button",
      "locator": {
        "strategy": "selector",
        "value": "button[type='submit']",
        "nth": 0
      }
    },
    {
      "action": "wait",
      "description": "Wait for results",
      "duration": 5000
    },
    {
      "action": "screenshot",
      "description": "Take screenshot of results",
      "save_to": "bt_results.png"
    },
    {
      "action": "extract",
      "description": "Extract broadband packages and pricing",
      "method": "vision",
      "prompt": "Extract all broadband packages shown on this page. For each package, identify:\n1. Package name/type (e.g., 'Fibre 1', 'Full Fibre 100')\n2. Download speed\n3. Upload speed (if shown)\n4. Monthly price\n5. Whether it's available (look for 'Available' or 'Not available' indicators)\n\nReturn as a structured list of packages.",
      "schema": {
        "type": "object",
        "properties": {
          "postcode": {
            "type": "string",
            "description": "The postcode that was checked"
          },
          "packages": {
            "type": "array",
            "description": "List of broadband packages",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Package name"
                },
                "download_speed": {
                  "type": "string",
                  "description": "Download speed (e.g., '67Mbps')"
                },
                "upload_speed": {
                  "type": "string",
                  "description": "Upload speed if available"
                },
                "price": {
                  "type": "number",
                  "description": "Monthly price in GBP"
                },
                "available": {
                  "type": "boolean",
                  "description": "Whether package is available"
                }
              },
              "required": ["name", "download_speed", "price", "available"]
            }
          }
        },
        "required": ["postcode", "packages"]
      }
    }
  ]
}
