{
  "name": "Form Filling with Progressive Escalation",
  "description": "Demonstrates intelligent form field detection, filling with progressive escalation, and validation",
  "llm_provider": "openai",
  "llm_model": "gpt-4o-mini",
  "starting_url": "https://httpbin.org/forms/post",
  "steps": [
    {
      "type": "navigate",
      "url": "https://httpbin.org/forms/post",
      "description": "Navigate to HTTPBin test form"
    },
    {
      "type": "wait_for_load_state",
      "description": "Wait for form to load",
      "state": "networkidle"
    },
    {
      "type": "wait",
      "description": "Wait for form to initialize (SPA pattern)",
      "duration": 1000
    },
    {
      "type": "screenshot",
      "description": "Screenshot of empty form",
      "save_to": "01_empty_form.png"
    },
    {
      "type": "extract",
      "description": "Analyze form structure and fields",
      "method": "vision",
      "prompt": "Analyze this HTML form and identify all form fields. For each field, extract:\n- Field name/label: What the field is called\n- Field type: text input, email, phone, select dropdown, radio button, checkbox, textarea, etc.\n- Is required: Whether the field appears to be required (often marked with * or 'required' text)\n- Current value: What value is currently in the field (if any)\n\nAlso check:\n- Is there a submit button?\n- What does the submit button say?",
      "schema": {
        "type": "object",
        "properties": {
          "form_fields": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "field_name": {
                  "type": "string",
                  "description": "Field label or name"
                },
                "field_type": {
                  "type": "string",
                  "description": "Type of input (text, email, select, radio, checkbox, textarea, etc.)"
                },
                "is_required": {
                  "type": "boolean",
                  "description": "Whether field appears required"
                },
                "current_value": {
                  "type": ["string", "null"],
                  "description": "Current value if any"
                }
              },
              "required": ["field_name", "field_type"]
            }
          },
          "has_submit_button": {
            "type": "boolean",
            "description": "Whether form has a submit button"
          },
          "submit_button_text": {
            "type": ["string", "null"],
            "description": "Text on submit button"
          }
        },
        "required": ["form_fields", "has_submit_button"]
      }
    },
    {
      "type": "fill",
      "description": "Fill customer name field",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[name='custname']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "#custname"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find the customer name input field. It's typically labeled 'Customer name' or similar.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ],
      "value": "John Doe"
    },
    {
      "type": "fill",
      "description": "Fill customer telephone field",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[name='custtel']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "#custtel"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find the telephone/phone number input field.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ],
      "value": "555-0123"
    },
    {
      "type": "fill",
      "description": "Fill customer email field",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[name='custemail']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[type='email']"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find the email address input field.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ],
      "value": "john.doe@example.com"
    },
    {
      "type": "click",
      "description": "Select Medium pizza size (radio button)",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[value='medium']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "text",
            "value": "Medium"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find and click the 'Medium' pizza size radio button option.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ]
    },
    {
      "type": "click",
      "description": "Select Bacon topping (checkbox)",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[value='bacon']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "text",
            "value": "Bacon"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find and click the 'Bacon' topping checkbox.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ]
    },
    {
      "type": "fill",
      "description": "Fill delivery time",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[name='delivery']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "input[type='time']"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find the delivery time input field.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ],
      "value": "19:00"
    },
    {
      "type": "fill",
      "description": "Fill delivery instructions textarea",
      "escalation_chain": [
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "textarea[name='comments']"
          },
          "confidence_threshold": 0.9
        },
        {
          "method": "playwright_locator",
          "locator": {
            "strategy": "selector",
            "value": "textarea"
          },
          "confidence_threshold": 0.85
        },
        {
          "method": "vision_find_element",
          "prompt": "Find the delivery instructions or comments textarea field.",
          "prefer": "selector",
          "fallback": "coordinates",
          "confidence_threshold": 0.7
        }
      ],
      "value": "Please ring doorbell twice and leave at door"
    },
    {
      "type": "screenshot",
      "description": "Screenshot of filled form",
      "save_to": "02_filled_form.png"
    },
    {
      "type": "extract",
      "description": "Validate form completion",
      "method": "vision",
      "prompt": "Look at this filled form and verify:\n1. Are all the required fields filled in?\n2. Is the submit button now enabled (not greyed out or disabled)?\n3. Are there any validation error messages visible?\n4. Does the form appear ready to submit?",
      "schema": {
        "type": "object",
        "properties": {
          "all_fields_filled": {
            "type": "boolean",
            "description": "True if all required fields appear filled"
          },
          "submit_button_enabled": {
            "type": "boolean",
            "description": "True if submit button appears enabled"
          },
          "any_validation_errors": {
            "type": "boolean",
            "description": "True if any error messages are visible"
          },
          "validation_error_messages": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of any error messages visible"
          },
          "ready_to_submit": {
            "type": "boolean",
            "description": "True if form appears ready to submit"
          }
        },
        "required": ["all_fields_filled", "submit_button_enabled", "any_validation_errors"]
      }
    },
    {
      "type": "extract",
      "description": "Extract all filled form data for verification",
      "method": "vision",
      "prompt": "Extract ALL the data that was filled into this form. Read each field's current value:\n- Customer name\n- Customer email\n- Customer phone\n- Pizza size (Small/Medium/Large)\n- Selected toppings (list all checked)\n- Delivery time\n- Delivery instructions/comments",
      "schema": {
        "type": "object",
        "properties": {
          "customer_name": {
            "type": "string",
            "description": "Name entered in customer name field"
          },
          "customer_email": {
            "type": "string",
            "description": "Email address entered"
          },
          "customer_phone": {
            "type": "string",
            "description": "Phone number entered"
          },
          "pizza_size": {
            "type": "string",
            "description": "Selected pizza size"
          },
          "selected_toppings": {
            "type": "array",
            "items": {"type": "string"},
            "description": "List of all selected toppings"
          },
          "delivery_time": {
            "type": "string",
            "description": "Delivery time specified"
          },
          "delivery_instructions": {
            "type": "string",
            "description": "Special delivery instructions"
          }
        },
        "required": ["customer_name", "customer_email"]
      }
    }
  ]
}
